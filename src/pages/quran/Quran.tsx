import React, { useState, useEffect } from "react";
import "./Quran.css";
import { Link } from "react-router-dom";
import Header from "../../components/header/Header";
import QuranSura from "../quranSura/QuranSura";
import { Sura, Page, Juz } from "../../DataBase/QuranDate";

const Quran: React.FC = () => {
  const [currentPage, setCurrentPage] = useState(1);
  const [itemValue, setItemValue] = useState("");
  // const [sura , setSura] = useState('')
  // const [juz , setJuz] = useState('')
  // const [page , setPage] = useState('')
  // const [favorite , setFavorite] = useState('')
  const [holder, setHolder] = useState("");

  let mainSura: [(string | number)[], number][] = [];
  let mainJuz: [string | number, number, number][] = [];
  let id = 0;

  useEffect(() => {
    if (currentPage === 1) {
      setHolder("نام سوره را تایپ کنید...");
      setItemValue("");
    } else if (currentPage === 2) {
      setHolder("شماره جزء را تایپ کنید...");
      setItemValue("");
    } else if (currentPage === 3) {
      setHolder("شماره صفحه را تایپ کنید...");
      setItemValue("");
    }
  }, [currentPage]);
  
  useEffect(() => {
    if (currentPage === 1) {
    } else if (currentPage === 2) {
    } else if (currentPage === 3 && itemValue) {
      if (+itemValue === 0) {
        setItemValue("1");
      } else if (+itemValue > 604) {
        setItemValue("604");
      }
    } else if (currentPage === 4) {
    }
  }, [itemValue]);

  Sura.map((sura, index) => {
    let preId = Page.findIndex((item) => index + 1 === +item[0]);
    if (preId !== -1) {
      id = preId + 1;
    }
    return mainSura.push([sura, id]);
  });
  mainSura.pop();

  Juz.map((juz) => {
    let preId = Page.findIndex(
      (item) =>
        item[0] === +juz[0] &&
        (item[1] === +juz[1] ||
          item[1] + 1 === +juz[1] ||
          item[1] === +juz[1] + 1)
    );
    if (preId !== -1) {
      id = preId + 1;
    }
    if (id === 482 && +juz[0] === 46) {
      id = 502;
    }
    let juzSura = Sura[juz[0] - 1];
    if (juzSura[1] !== 1) {
      return mainJuz.push([juzSura[4], id, juz[1]]);
    }
    return 0;
  });
  return (
    <div className="quranContainer">
      <div>
        <Header headerName={"قرآن"} isSetting={true} />
      </div>

      <div className="quranMain">
        <i className="icon topIcon">
          <svg fill="none" viewBox="0 0 414 140" className="svg">
            <path
              fill="url(#a)"
              d="M418 123.304c-8.916-55.1-65.369-53.544-71.534-53.374h-.002c-.217.006-.371.01-.459.01l-3.322.368v-3.312c0-6.992-2.216-12.145-6.277-16.193-11.568-11.171-38.711-10.345-62.713-9.615h-.001l-1.527.046c-3.421 0-6.646.098-9.776.192-2.951.09-5.818.176-8.685.176-25.475 0-39.504-16.561-46.15-27.602-6.277 11.04-20.675 27.602-46.15 27.602-5.908 0-12.184 0-18.461-.368-24.367-1.104-52.427-1.84-64.241 9.569-4.43 4.048-6.277 9.2-6.277 16.193v3.312l-3.322-.368-.1-.004c-1.97-.082-31.872-1.329-52.697 16.566C4.123 96.806-2.523 111.896-4 131.4v4.6h422v-12.696z"
              opacity=".35"
            ></path>
            <path
              fill="url(#b)"
              d="M417.746 140v-17.315c-8.884-54.505-65.136-52.965-71.279-52.797-.216.006-.371.01-.458.01l-3.311.364v-3.276c0-6.918-2.208-12.014-6.254-16.019-11.528-11.05-38.574-10.233-62.49-9.511l-1.522.046c-3.409 0-6.622.096-9.741.19-2.941.088-5.797.174-8.654.174-25.384 0-39.363-16.382-45.985-27.304-6.254 10.922-20.602 27.304-45.986 27.304-5.886 0-12.14 0-18.394-.364-24.28-1.092-52.24-1.82-64.012 9.465-4.414 4.005-6.254 9.102-6.254 16.019v3.276l-3.31-.364-.1-.004c-1.96-.081-31.757-1.316-52.508 16.386C5.348 96.474-1.274 111.4-2.746 130.695V140H-9v-11.854l.368-.364c1.84-20.023 9.565-35.677 22.44-46.962C32.939 64.437 58.324 62.98 67.52 62.98c.736-6.917 3.31-12.742 8.093-17.11 13.98-13.106 43.043-12.014 68.795-10.922 3.225 0 6.449.097 9.573.19 2.935.089 5.78.174 8.453.174 26.488 0 38.996-20.387 43.043-29.124L208.42 0l3.311 5.825c4.046 8.737 16.554 29.124 43.042 29.124 5.518 0 11.772 0 18.027-.364l1.453-.041c25.384-.723 53.603-1.526 66.237 11.69 4.783 4.37 7.358 10.194 8.094 17.111 13.979 0 66.587 3.64 75.416 58.248V140h-6.254z"
            ></path>
            <path
              fill="#8E816C"
              d="M209.101 30.043c1.391-.243 2.912.562 3.302 1.95.645 1.886-.283 3.756-1.141 5.404-1.177 2.088-2.417 4.164-3.157 6.458-.477 2.07-.7 4.298-.103 6.366-.401 1.158-.773 2.349-1.185 3.513-.375-.067-.341-.672-.498-.975-.817-3.316.233-6.75 1.523-9.819.898-2.36 2.677-4.448 2.723-7.076.15-1.121-.542-2.485-1.747-2.634-2.958-.4-5.353 1.8-7.418 3.598-1.71 1.375-3.231 2.962-4.889 4.395-2.978 2.854-6.823 4.498-10.61 5.953 2.154 2.346 5.166 3.83 7.058 6.459 1.987 2.495 3.14 5.696 2.926 8.903.072 1.602-.552 3.253-1.737 4.347-.464.343-.356 1.026-.537 1.502-.343 1.896-.633 4.183.858 5.686 1.137.959 2.733.785 4.112.785 2.314-.512 4.327-2.122 5.397-4.227-.566-4.585-3.123-8.611-5.772-12.281-2.72-4.224-3.216-9.793-1.166-14.395.408-.846.599-1.941 1.379-2.536-.012.318-.218.568-.38.826-.888 1.494-.934 3.251-1.145 4.93.112 4.32 2.273 8.291 5.011 11.524 1.955 2.463 3.293 5.463 3.499 8.623.275 3.871-1.593 7.848-4.769 10.099-1.892 1.28-4.475 2.116-6.616.984-1.588-.937-1.98-2.86-2.024-4.558a20.562 20.562 0 011.538-6.57c-.508.298-1.09.293-1.659.357-1.069 2.843-1.825 5.86-1.741 8.915-.028 2.502 1.417 5.13 3.893 5.89.606.159.242-.845.665-1.023-.192 2.568.189 5.3 1.697 7.452.996 1.47 2.806 2.235 4.553 2.201 2.605-.292 4.951-1.599 7.09-3.042 2.839-1.965 5.88-3.893 9.342-4.474 1.464-.158 2.998-.234 4.389.348 1.496.525 2.789 1.545 4.33 1.942-.423-2.892-.526-5.865.066-8.74.409-1.28.946-2.72 2.24-3.319 1.216-.354 2.61-.131 3.491.851 1.479 1.941 1.572 4.475 1.793 6.807.002.79.105 1.608-.16 2.37 1.109-.135 2.034-1.003 2.836-1.727 1.33-1.297 2.367-2.964 2.671-4.815-1.4-3.514-4.749-5.687-7.715-7.792-3.642-2.703-7.651-5.384-9.596-9.648-1.181-2.669-1.59-5.785-.709-8.61.5-1.676 1.128-3.342 2.144-4.782.174-.235.189-.667.571-.631-1.135 2.226-1.813 4.77-1.501 7.276.152 3.094 1.85 5.86 3.832 8.142 2.865 3.141 6.844 4.922 9.96 7.765 1.786 1.366 3.12 3.412 3.471 5.65.284 2.077.539 4.24-.057 6.287-.576 3.003-2.649 5.616-5.397 6.938-1.354.763-2.975.876-4.226 1.847-2.14 1.254-4.919.498-6.629-1.131-.993-.647-2.109-1.24-3.327-1.228-3.091-.212-5.89 1.356-8.49 2.82-3.093 1.745-5.898 4.301-9.524 4.84-2.109.455-4.408-.488-5.612-2.266-1.08-1.53-1.909-3.314-2.064-5.196-.725-.43-1.611-.57-2.3-1.08-2.189-1.422-3.413-3.99-3.573-6.545-.373-4.356 1.435-8.497 3.347-12.293-.668-.193-1.274-.625-2.005-.54-1.148-.093-2.202.504-3.154 1.072-2.323 1.5-4.245 3.507-6.163 5.48-2.215 2.594-4.737 5.057-7.904 6.453-2.211.898-5.09 1.14-6.916-.694.125.858-.257 1.91.199 2.684 1.253 2.144 3.695 3.375 6.103 3.658 2.92.27 5.842-.783 8.217-2.442 3.964-3.085 6.204-7.955 7.123-12.806l.138-.044c.027 4.907-.785 10.127-3.731 14.19-2.189 2.672-5.208 4.85-8.651 5.51-1.462.098-3.021.255-4.386-.383-1.928-.73-3.351-2.35-4.339-4.106-1.234-2.468-2.188-5.149-2.211-7.936.126-.74-.36-1.328-.515-2.01a14.566 14.566 0 01-.235-5.985c.554-3.214 1.574-6.35 3.127-9.225.302-.427.359-1.104.857-1.364-.339 1.112-1.083 2.073-1.384 3.209-.993 2.519-1.592 5.231-1.499 7.951.211 2.178 1.315 4.441 3.38 5.397a5.58 5.58 0 005.066.174c2.731-1.256 4.757-3.56 6.881-5.612 1.35-1.735 3.053-3.15 4.726-4.56 1.634-1.075 3.387-2.268 5.439-2.163 1.089-.257 1.967.626 3.039.513.694.128 1.432.083 1.827-.552.221-2.347-1.005-4.523-2.362-6.337-1.749-2.35-4.234-3.95-6.687-5.472-.771-.866-1.571-1.85-1.656-3.055-.202-1.49.574-2.9 1.324-4.123.994-.8 2.297-1.038 3.477-1.443 3-1.183 5.924-2.659 8.426-4.72 2.026-1.508 3.334-3.761 5.415-5.215 1.894-1.483 4.05-2.85 6.501-3.094zm19.75 47.585c-1.563.3-2.257 2.009-2.512 3.417-.289 1.38.675 2.763 1.899 3.319.954.422 2.017.542 3.054.435.55-.597.979-1.303 1.386-2.002.477-.834.027-1.85-.181-2.697-.473-1.494-1.96-2.983-3.646-2.472z"
            ></path>
            <path
              fill="#8E816C"
              d="M213.491 36.081l.283-.062c-1.212 1.786-1.722 3.949-1.698 6.09-.074 3.073 1.02 5.992 2.235 8.76l.25-.04c2.139-1.663 4.504-3.101 6.312-5.142-.692-.268-1.293-.783-1.362-1.551.124-.868.756-1.635 1.527-2.028 1.194.19.876 1.764.741 2.667.406.387.76 1.01.401 1.54-.444.169-.62-.338-.954-.47-1.775 2.31-3.944 4.34-6.618 5.572 1.086 2.398 2.804 4.485 3.893 6.897 1.501 2.838 2.431 6.04 2.164 9.277-.388 2.19-1.335 4.42-3.189 5.766.139-.62.733-1.031.917-1.65.525-1.024.328-2.178.55-3.264-.175-3.454-1.62-6.682-3.275-9.66-1.178-1.94-2.463-3.82-3.435-5.876-.625.238-1.217.623-1.869.83.245-.65 1.201-.724 1.682-1.19-.422-1.348-1.118-2.611-1.283-4.034-.23-1.73-.561-3.488-.208-5.225.285-2.623 1.511-5.024 2.936-7.206z"
            ></path>
            <path
              fill="#8E816C"
              d="M219.224 39.127c.801-.162 1.877 1.003 1.245 1.75-.185.21-.361.451-.614.58-.267-.254-.434-.6-.721-.838-.427-.175-.679.264-.92.529-.56 1.166-.761 2.466-1.239 3.663-.186.562-.635.976-1.172 1.19.027-1.173.495-2.526-.138-3.589-.707-.31-1.518-.544-2.039-1.178-.122-.799.55-1.607 1.156-1.994 1.376.59 2.093 2.105 2.046 3.545.64-1.08.788-3.251 2.396-3.658zm-15.191 1.843a22 22 0 00.286-.055c-2.109 3.406-1.905 7.789-.61 11.455.905 2.845 2.347 5.487 3.972 7.98 1.724 2.838 3.291 5.91 3.556 9.28.383 2.362-.13 4.93-1.569 6.87-.494.43-.756 1.324-1.475 1.41 1.786-2.149 1.523-5.206 1.001-7.775-.868-2.796-2.071-5.494-3.69-7.938-1.653-2.573-3.209-5.255-3.929-8.255-.477-2.461-.763-5.05-.028-7.494.369-2.009 1.49-3.739 2.486-5.478zm21.236 1.16l.153-.029a8.441 8.441 0 00.367 6.4c1.801 4.204 5.272 7.335 8.692 10.218 2.569 2.077 5.056 4.366 6.761 7.234 1.975 2.833 2.881 6.319 2.745 9.754-.264 3.785-2.094 7.222-4.265 10.254l-.302.049c3.003-3.871 3.996-9.332 2.099-13.905-1.334-3.52-3.836-6.444-6.539-8.997-3.491-2.962-7.237-5.803-9.543-9.868-1.283-2.337-2.14-5.078-1.504-7.742.335-1.16.755-2.306 1.336-3.368zm-31.554 2.21l.146-.046c-.487 1.393-1.265 2.722-1.418 4.216-.225.734.16 1.642.95 1.818.712.23 1.04-.613 1.462-.991.324 1.252-.309 3.346-2.011 2.898-1.416-.422-1.463-2.253-1.099-3.425a13.208 13.208 0 011.97-4.47zm-12.998.186l.11-.063c.425 1.908.67 4.031-.488 5.746-2.034 3.096-6.163 3.47-8.741 5.943-.399.555-1.416 1.556-.588 2.218 1.645 1.897 4.302 2.095 6.635 2.306 1.506-.345 2.959-.924 4.509-1.07 1.067-.115 2.181-.406 3.241-.076-.24 1.426-.057 2.956-.527 4.328-1.757.44-3.563.674-5.365.85-.499.073-1.065-.09-1.524.185-2.114.849-4.099 2-5.908 3.378-.662.46-1.108 1.171-1.81 1.578-1.234 1.273-2.247 2.75-3.137 4.281-.147.206-.028.704-.42.53-.805-.736-1.589-1.73-1.712-2.829 1.405-3.19 3.824-5.854 6.635-7.875.18-.174.741-.18.577-.53-1.202-.498-1.827-1.697-2.222-2.861-.417-1.884-.672-3.877-.243-5.78.296-1.233 1.143-2.188 1.867-3.188 2.516-2.303 6.341-2.733 8.377-5.633.413-.38.528-.939.734-1.438z"
            ></path>
            <path
              fill="#8E816C"
              d="M184.409 51.729c1.313.738 2.889 1.71 3 3.368-.238 1.63-1.501 2.767-2.846 3.555-.925-.679-1.628-2.392-3.014-2.355-.574 1.161-1.308 2.287-2.382 3.039-.16.089-.428.288-.526.01-.704-1.128-2.578-1.756-2.291-3.34.398-.952 1.131-1.698 1.617-2.6.184-.306.451-.61.849-.489.721.3 1.356.777 1.991 1.224.374.355.786.888 1.374.792.839-1 1.474-2.144 2.228-3.204zm27.404 2.093l.226-.088c-.154.952-.162 1.923-.113 2.887.535 4.01 4.262 6.638 4.961 10.583.385 2.657-.27 5.353-1.291 7.8-3.052 7.71-11.216 13.089-19.524 12.667-.869-1.454-.942-3.246-1.215-4.88 5.034.786 10.286-.669 14.293-3.78 2.639-2.023 4.965-4.553 6.473-7.538-.044-.84-.546-1.592-.799-2.382-1.22-2.86-3.95-4.85-4.715-7.937-.79-2.568.031-5.32 1.704-7.332zm-23.163 3.339l.3-.04c-.498 1.1-1.487 2.446-.79 3.678.741.505 1.659.144 2.323-.302-.287-.822-1.438-.842-2.193-1.03-.182-.616.495-1.369 1.123-1.095.565.151 1.075.46 1.522.832 1.177 1.894-2.115 4.117-3.449 2.44-.682-1.54.433-3.154 1.164-4.483zm10.093 8.083c1.308.36 2.421 1.587 2.865 2.877.184 2.003-1.461 3.487-2.816 4.711-.346-1.219-1.32-2.06-2.2-2.905-.209-.407-.638-.804-.53-1.302.112-.412.258-.817.539-1.146.732-.728 1.262-1.673 2.142-2.235zm24.015 1.71c.559-.174.907.57 1.381.733 1.553.947 1.957 3.254.768 4.637-.175.417-.675.613-.839 1.025-.072.543.868.393.839 1.007.77.863.962 2.21.348 3.208-.508 1.194-1.59 1.982-2.492 2.872-.168-.958-.742-1.844-1.57-2.362-.72-.426-1.171-1.364-1.009-2.195.386-1.057 1.413-1.671 2.032-2.539-.395-1.084-1.806-1.328-2.029-2.542-.152-1.739 1.601-2.676 2.571-3.844zm-49.95 1.543l.274-.07c-.495 1.103-1.488 2.449-.79 3.683.754.476 1.919.182 2.459-.443-.621-.636-1.523-.688-2.331-.891-.073-.447.238-.829.533-1.124.885-.129 1.638.557 2.328.996.549 1.814-1.889 3.665-3.418 2.564-.753-.631-.518-1.793-.129-2.574.311-.737.591-1.494 1.074-2.141z"
            ></path>
            <path
              fill="#8E816C"
              d="M206.395 71.877c.284-.221-.005.337-.084.418-.68 1.38-1.266 2.868-1.32 4.425.012.792 1.109 1.599 1.757.918.39-.197.377-.753.765-.954.226 1.294-.272 3.377-2.009 3.071-1.136-.36-1.555-1.593-1.329-2.689.348-1.847 1.012-3.746 2.22-5.19zm11.483 2.691c.069-.016.206-.046.275-.063-.726 1.432-1.344 2.927-1.595 4.52-.142.796.442 1.907 1.428 1.574.53-.116.685-.682 1.001-1.051-.027.953.206 2.534-.991 2.912-.778.477-1.867-.13-2.092-.96-.606-2.515.826-4.822 1.974-6.932zm-35.122 1.014c.336-.153.676.127.929.326.537.39.175 1.22-.16 1.64-.504.097-.62-.747-1.11-.636-.818 1.486-.432 3.618-1.878 4.73-.034-.855.052-1.725-.211-2.552.01-.162-.257-.525-.338-.2-.353.928-.94 1.74-1.83 2.22-1.501.732-3.007 1.456-4.409 2.364.634-2.056 3.155-2.33 4.704-3.417.409-.514 1.157-.904 1.211-1.625-.389-.31-.949-.249-1.334-.562-.113-.688.253-1.32.692-1.807.434.196.892.399 1.202.775.616.483.517 1.44 1.101 1.936.121-1.124.206-2.684 1.431-3.192zm4.226 7.269l.125-.074c-.306 1.048-1.032 1.946-1.187 3.055-.236.932-.767 2.485.5 2.875.849.596 1.235-.609 1.683-1.048.052.97.109 2.463-.998 2.909-.826.523-1.85-.09-2.141-.905-.555-1.681.284-3.395.856-4.956.372-.623.586-1.39 1.162-1.856z"
            ></path>
            <defs>
              <linearGradient
                id="a"
                x1="207"
                x2="203.5"
                y1="14"
                y2="118.5"
                gradientUnits="userSpaceOnUse"
              >
                <stop stopColor="#D6BB8B"></stop>
                <stop offset="1" stopColor="#674B14" stopOpacity="0"></stop>
              </linearGradient>
              <linearGradient
                id="b"
                x1="-73.771"
                x2="388.637"
                y1="376.798"
                y2="376.798"
                gradientUnits="userSpaceOnUse"
              >
                <stop stopColor="#B26B2A"></stop>
                <stop offset=".058" stopColor="#B7722E"></stop>
                <stop offset=".142" stopColor="#C5853A"></stop>
                <stop offset=".241" stopColor="#DBA44D"></stop>
                <stop offset=".333" stopColor="#F4C762"></stop>
                <stop offset=".516" stopColor="#F4D38B"></stop>
                <stop offset=".661" stopColor="#F4C762"></stop>
                <stop offset="1" stopColor="#B26B2A"></stop>
              </linearGradient>
            </defs>
          </svg>
        </i>
        <div className="quranCenter">
          <form className="quranSwitcher">
            <div className="multiSwitch">
              <button
                type="button"
                onClick={() => setCurrentPage(1)}
                className={
                  currentPage === 1
                    ? "multiSwitchButton multiSwitchButton--active"
                    : "multiSwitchButton"
                }
              >
                سوره
              </button>
              <button
                type="button"
                onClick={() => setCurrentPage(2)}
                className={
                  currentPage === 2
                    ? "multiSwitchButton multiSwitchButton--active"
                    : "multiSwitchButton"
                }
              >
                جزء
              </button>
              <button
                type="button"
                onClick={() => setCurrentPage(3)}
                className={
                  currentPage === 3
                    ? "multiSwitchButton multiSwitchButton--active"
                    : "multiSwitchButton"
                }
              >
                صفحه
              </button>
            </div>
            <input
              type="text"
              placeholder={holder}
              value={itemValue}
              onChange={(event) => setItemValue(event.target.value)}
              className="multiSwitchInput"
            />
          </form>
        </div>
        <div className="quranHome">
          {currentPage === 1 ? (
            <>
              {mainSura.map((sura: [(string | number)[], number], index: number) => (
                <div key={index}>
                  <Link to={`/page/${sura[1]}`} className="Link">
                    <QuranSura sura={sura[0]} index={index} />
                  </Link>
                </div>
              ))}
            </>
          ) : (
            ""
          )}
          {currentPage === 2 ? (
            <>
              {mainJuz.map((item: any, index: number) => (
                <div key={index}>
                  <Link to={`/page/${item[1]}`} className="Link">
                    <QuranSura juz={item} index={index} />
                  </Link>
                </div>
              ))}
            </>
          ) : (
            ""
          )}
          {currentPage === 3 && +itemValue !== 0 && +itemValue <= 604 ? (
            <>
              <Link to={`/page/${+itemValue}`} className="Link">
                <QuranSura page={+itemValue} index={+itemValue - 1} />
              </Link>
            </>
          ) : (
            ""
          )}
        </div>
      </div>
    </div>
  );
};

export default Quran;
